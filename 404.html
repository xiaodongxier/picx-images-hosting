<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¯·ç¨ç­‰ï¼Œå›¾ç‰‡æ­£åœ¨åŠ è½½</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#38bdf8',
            secondary: '#818cf8',
            dark: '#0f172a',
            darker: '#020617'
          },
          fontFamily: {
            sans: ['Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'sans-serif'],
          },
        },
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 0 10px rgba(56, 189, 248, 0.7);
      }
      .bg-gradient-custom {
        background: linear-gradient(135deg, #0f172a, #1e293b);
      }
      .balloon-pop {
        animation: pop 0.3s ease-out forwards;
      }
      @keyframes pop {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.5); opacity: 0.8; }
        100% { transform: scale(2); opacity: 0; }
      }
      .float {
        animation: float 3s ease-in-out infinite;
      }
      @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }
    }
  </style>
</head>

<body
  class="bg-gradient-custom text-white font-sans flex flex-col items-center justify-center min-h-screen overflow-hidden m-0">
  <!-- ç‚¹å‡»æ•ˆæœå®¹å™¨ -->
  <div id="clickEffects" class="fixed inset-0 pointer-events-none z-50"></div>

  <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 float">å›¾ç‰‡è¿˜åœ¨è·¯ä¸Š ğŸššğŸ’¨</h1>

  <div id="timer" class="text-[clamp(2rem,5vw,4rem)] font-bold text-primary text-shadow my-2">60s</div>

  <div id="msg" class="text-gray-300 text-[clamp(1rem,2vw,1.2rem)] mb-6">
    åˆ«æ€¥ï¼Œä¸€åˆ‡æ­£åœ¨å‡†å¤‡ä¸­â€¦
  </div>

  <!-- æ¸¸æˆåŒºåŸŸ -->
  <div class="relative w-full max-w-md">
    <canvas id="gameCanvas"
      class="w-full h-[250px] bg-white/5 rounded-xl shadow-lg shadow-primary/10 border border-white/10"></canvas>

    <!-- æ¸¸æˆä¿¡æ¯ -->
    <div class="flex justify-between mt-3 text-sm text-gray-300">
      <div>å¾—åˆ†: <span id="score" class="text-primary font-bold">0</span></div>
      <div>æ°”çƒ: <span id="balloonsPopped" class="text-secondary font-bold">0</span></div>
    </div>

    <!-- æ¸¸æˆè¯´æ˜ -->
    <div class="mt-2 text-xs text-gray-400 text-center">
      ç‚¹å‡»æ°”çƒå¾—åˆ† | é»„è‰²æ°”çƒåˆ†æ•°æ›´é«˜å“¦!
    </div>
  </div>

  <!-- éŸ³ä¹æç¤º -->
  <!-- <div id="musicTip" class="mt-6 text-sm text-gray-400 flex items-center">
    <i class="fa fa-music mr-2"></i>
    <span>ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®æ’­æ”¾èƒŒæ™¯éŸ³ä¹</span>
  </div> -->

  <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆæ¢æˆæ¸©æŸ”é’¢ç´æ›²ï¼‰ -->
  <!-- <audio id="bgm" src="https://cdn.pixabay.com/audio/2025/04/04/audio_588416cc0f.mp3" loop preload="auto"></audio> -->

  <!-- éŸ³æ•ˆ -->
  <audio id="popSound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_5b4d3bfb9e.mp3" preload="auto"></audio>

  <script>
    // å€’è®¡æ—¶åŠŸèƒ½
    let seconds = 60;
    const timerEl = document.getElementById('timer');
    const msgEl = document.getElementById('msg');
    const messages = [
      "âŒ› ç½‘ç»œæ­£åœ¨å¸®ä½ æ‰“åŒ…å¿«é€’â€¦",
      "ğŸ¢ æœ‰ç‚¹æ…¢ï¼Œä½†ä¹Œé¾Ÿä¹Ÿèƒ½åˆ°ç»ˆç‚¹ï¼",
      "ğŸµ ç­‰å¾…çš„æ—¶å€™ï¼Œä¸å¦¨ç©ä¼šå„¿å°æ¸¸æˆï½",
      "ğŸ¤– æ­£åœ¨åŠªåŠ›å”¤é†’å›¾ç‰‡â€¦",
      "ğŸŒŒ æ”¾æ¾ä¸€ä¸‹çœ¼ç›ï¼Œçœºæœ›ä¸€ä¸‹è¿œæ–¹å§ã€‚",
      "ğŸˆ ç‚¹å‡»æ°”çƒå¯ä»¥å¾—åˆ†å“¦ï¼",
      "â³ æ—¶é—´è¿‡å¾—å¾ˆå¿«çš„..."
    ];

    function updateTimer() {
      timerEl.textContent = seconds < 10 ? `0${seconds}s` : `${seconds}s`;

      if (seconds % 7 === 0) {
        msgEl.textContent = messages[Math.floor(Math.random() * messages.length)];
      }

      if (seconds > 0) {
        seconds--;
        setTimeout(updateTimer, 1000);
      } else {
        msgEl.textContent = "âœ… å›¾ç‰‡åº”è¯¥èƒ½åŠ è½½äº†ï¼Œé©¬ä¸Šåˆ·æ–°â€¦";
        setTimeout(() => { location.reload(); }, 2000);
      }
    }
    updateTimer();

    // éŸ³ä¹æ§åˆ¶
    const bgm = document.getElementById('bgm');
    const popSound = document.getElementById('popSound');
    const musicTip = document.getElementById('musicTip');
    let musicPlaying = false;

    function playMusic() {
      if (!musicPlaying) {
        bgm.play().then(() => {
          musicPlaying = true;
          musicTip.innerHTML = '<i class="fa fa-music mr-2"></i><span>èƒŒæ™¯éŸ³ä¹æ­£åœ¨æ’­æ”¾</span>';
          musicTip.classList.add('text-primary');
        }).catch(() => { });
      }
    }

    // ç‚¹å‡»æ•ˆæœ
    function createClickEffect(x, y) {
      const effect = document.createElement('div');
      effect.className = 'absolute rounded-full bg-primary/30 transform -translate-x-1/2 -translate-y-1/2';
      effect.style.width = '40px';
      effect.style.height = '40px';
      effect.style.left = `${x}px`;
      effect.style.top = `${y}px`;
      effect.style.animation = 'pop 0.6s ease-out forwards';

      document.getElementById('clickEffects').appendChild(effect);

      setTimeout(() => effect.remove(), 600);
    }

    // å…¨å±€ç‚¹å‡»
    document.addEventListener('click', (e) => {
      playMusic();
      createClickEffect(e.clientX, e.clientY);
    });

    // æ°”çƒæ¸¸æˆ
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let score = 0;
    let balloonsPopped = 0;
    const balloons = [];
    const colors = ['#38bdf8', '#818cf8', '#f87171', '#fbbf24', '#4ade80'];

    function resizeCanvas() {
      const { width, height } = canvas.getBoundingClientRect();
      if (canvas.width !== width || canvas.height !== height) {
        canvas.width = width;
        canvas.height = height;
      }
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    class Balloon {
      constructor() { this.reset(); }
      reset() {
        this.x = Math.random() * canvas.width;
        this.y = canvas.height + 20;
        this.radius = Math.random() * 15 + 15;
        this.color = colors[Math.floor(Math.random() * colors.length)];
        this.speed = Math.random() * 0.8 + 0.4;
        this.popped = false;
        this.points = this.color === '#fbbf24' ? 3 : 1;
      }
      update() {
        if (!this.popped) {
          this.y -= this.speed;
          if (this.y + this.radius < 0) this.reset();
        }
      }
      draw() {
        if (!this.popped) {
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          ctx.fillStyle = this.color;
          ctx.fill();
          ctx.beginPath();
          ctx.arc(this.x - this.radius * 0.3, this.y - this.radius * 0.3, this.radius * 0.2, 0, Math.PI * 2);
          ctx.fillStyle = 'rgba(255,255,255,0.6)';
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(this.x, this.y + this.radius);
          ctx.lineTo(this.x, this.y + this.radius + 15);
          ctx.strokeStyle = '#fff';
          ctx.stroke();
        }
      }
      checkClick(x, y) {
        if (!this.popped) {
          const dx = x - this.x, dy = y - this.y;
          return dx * dx + dy * dy <= this.radius * this.radius;
        }
        return false;
      }
      pop() {
        if (!this.popped) {
          this.popped = true;
          balloonsPopped++;
          score += this.points;
          document.getElementById('score').textContent = score;
          document.getElementById('balloonsPopped').textContent = balloonsPopped;

          // æ’­æ”¾æ°”çƒéŸ³æ•ˆï¼ˆç‹¬ç«‹ï¼Œä¸ä¾èµ–èƒŒæ™¯éŸ³ä¹ï¼‰
          popSound.currentTime = 0;
          popSound.play().catch(() => { });

          setTimeout(() => this.reset(), 500);
        }
      }
    }

    function initBalloons() {
      for (let i = 0; i < 5; i++) balloons.push(new Balloon());
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      balloons.forEach(b => { b.update(); b.draw(); });
      if (Math.random() < 0.02 && balloons.length < 8) balloons.push(new Balloon());
      requestAnimationFrame(gameLoop);
    }

    canvas.addEventListener('click', (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left, y = e.clientY - rect.top;
      balloons.forEach(b => { if (b.checkClick(x, y)) b.pop(); });
    });

    initBalloons();
    gameLoop();
  </script>
</body>

</html>